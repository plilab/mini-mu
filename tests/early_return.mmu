import "std_nat" (add, eq)

fn find_pair_sum xs ys target k :=
  match xs with
    Nil -> NO_RESULT . k
  | List:: x xs' -> 
    dispatch find_pair_sum_aux(x, ys, target) with
      (x, y) -> (x, y) . k -- found a pair, early return, hard to do in fp
    | _ -> find_pair_sum(xs', ys, target) . k;

fn find_pair_sum_aux x ys target k :=
  match ys with
    Nil -> NO_RESULT . k
  | List:: y ys' -> 
    let s = add(x, y) in
    dispatch eq(s, target) with
      True -> (x, y) . k
    | _ -> find_pair_sum_aux(x, ys', target) . k;

l1 = (List:: 1 (List:: 2 (List:: 3 Nil)));
l2 = (List:: 4 (List:: 5 (List:: 6 Nil)));

run find_pair_sum @ l1 l2 8 halt;
