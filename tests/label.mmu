import "std_nat" (mul)

fn list_mult xs k := 
    xs . { Nil -> 1 . k
         | List:: 0 xs' -> 0 . k
         | List:: x xs' ->
            do rest <- list_mult xs',
                acc <- mul x rest
            then acc . k }; -- how partial application/currying works in minimu?

superlonglist = List:: 3 (List:: 5 (List:: 2 (List:: 4 (List:: 6 (List:: 8 (List:: 7 (List:: 9 (List:: 1 Nil))))))));

run list_mult @ (List:: 2 (List:: 0 (List:: 4 superlonglist))) halt;
-- successful short-circuiting to 0
-- much easier than control operators in lambda calculus
